<?xml version="1.0" encoding="UTF-8"?><topic id="7a4ded7e-6893-4283-8507-22575cb7e4bb"><title id="031a9203-60cb-46e7-b2bf-e7e21fe90d45">Hilfreiche XQuery Schippsel</title><body id="a208acaa-4319-41fa-83d9-752afeae469b"><p id="05773d2d-9893-43af-8d09-42f0576d575f">Unsortierte Schnippsel für die MarkLogic Konsole, die an mancher Stelle hilfreich sein könnten:</p><dl id="a5000499-e8e9-4c65-b38b-3c9a6e9026d6d7e6"><dlhead id="b7fd3af4-43b2-4bcc-9508-c7415ceb144dd7e7"><dthd id="2a8b10fb-1228-4c1c-8758-04703de7c4bfd7e8">Beschreibung</dthd><ddhd id="14292127-92e7-4528-b1b4-1be426713b9ed7e10">Beispiel Code Schnippsel</ddhd></dlhead><dlentry id="18e4406d-c2b9-4e7c-8eef-6b7c5311f058d7e12"><dt id="09b4bb9c-570f-4893-ab46-87c1fb46b817d7e13">Datenbank löschen</dt><dd id="094d55d5-f27a-4bc4-876a-908c32f42546d7e15"><pre id="e7763f60-99b8-4c42-a99f-f90001ffe36fd7e16" xml:space="preserve">xdmp:forest-clear(

xdmp:database-forests(

xdmp:database("xml-scrapper-content")))</pre></dd></dlentry><dlentry id="1db258fe-af34-4508-9480-79e91d0b48dbd7e18"><dt id="9059b5f2-5680-4f4c-ae0a-96b15683cb6cd7e19">Über Collection iterieren</dt><dd id="f9addca9-f0dd-4eac-8868-992f0a28ef12d7e21"><pre id="7ccd19f6-c97f-4a8d-a78f-ab19d043b5c2d7e22" xml:space="preserve">for $x in collection("/topics")
return
 (&lt;fname&gt;{ fn:document-uri($x) }&lt;/fname&gt;,
 $x)</pre></dd></dlentry><dlentry id="d7a87293-7f4e-4ac7-900b-fa73d9c3ba53d7e24"><dt id="6149167b-6070-4dda-b543-04f48464f5abd7e25">Attribut / Knoten ersetzen</dt><dd id="56dd3b6c-8582-4a42-9732-8f2f690c1521d7e27"><pre id="9f16944d-71fa-4c78-949f-b6f8fe1e2cf4d7e28" xml:space="preserve">for $ref in collection("/topics")//topicref
    let $topic := collection("/topics")
               [contains(fn:document-uri(.),$ref/@href)],
        $new := attribute href { $topic/topic/@id }
return 
  xdmp:node-replace($ref/@href,  $new)</pre></dd></dlentry><dlentry id="ccfadc33-1e2f-4e32-bb18-b42006225027d7e30"><dt id="fdd7825a-ee90-4981-8547-49f9568b23e9d7e31">Dokument [[link]]"umbenennen"[[fn:https://developer.marklogic.com/recipe/move-a-document/*Rezept, wie man ein Dokument in MarkLogic "umbenennt"]]</dt><dd id="64341001-07ec-47f9-a8af-a6c5b3c78799d7e33"><pre id="c4a5a336-5f9c-4b2d-8ff8-979cae6d5129d7e34" xml:space="preserve">xdmp:document-insert(
  $new-uri,
  fn:doc($old-uri),
  xdmp:document-get-permissions($old-uri),
  xdmp:document-get-collections($old-uri)
 ),
 xdmp:document-delete($old-uri),
 xdmp:document-set-properties($new-uri, $properties</pre></dd></dlentry><dlentry id="742e10cf-94a6-493d-87eb-2948bfa44404d7e36"><dt id="aeaf25dd-5fb5-4da0-b113-344b14a374e9d7e37">Über verschiedene Collections bestimmte Elemente suchen</dt><dd id="62e91665-7cd8-4e81-b919-8a23d2dd4b99d7e39"><pre id="6ea92e42-5c16-4f2e-bd44-19797e200bebd7e40" xml:space="preserve">for $element in cts:search(/descendant::*[self::b or 
                                         self::i or self::u], 
                cts:collection-query(("/topics", 
                                      "/tasks", "/maps")))
return $element/text()</pre></dd></dlentry><dlentry id="1e48802c-5681-44f2-b9ae-665df683b775d7e42"><dt id="ff867821-b16c-4ac2-8a4d-63ad16a176f7d7e43">Ein Element aus einem "Stack" holen und das Element vom Stack nehmen ("Pop")</dt><dd id="4e8c9009-fe24-45f7-8a4b-e4a45aebecedd7e45"><pre id="43401248-5141-4d2a-9665-afe3608ff61cd7e46" xml:space="preserve">let $result := ( 
  for $stack in collection("/stack-pushed")
  order by $stack/some-element/some-criterion descending
  return
    $stack)[1] 
return (
  local:render-response($result),
  xdmp:document-set-collections(fn:document-uri($result), 
                               ("/stack-popped")</pre></dd></dlentry></dl></body></topic>