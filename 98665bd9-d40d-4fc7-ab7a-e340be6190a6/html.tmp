<div data-attribute-id="06abe1b7-21be-4794-bec6-c28732cf6cbf" class="topic show_menu tags" data-element="topic" data-deletable="false" data-tektur-editor-id="4c07819a-3b7f-49df-a881-9ee5422c912b"><div class="gui-optional-elements-button" contenteditable="false"><div class="menu-icon" style="display:none">+</div></div><div data-attribute-id="8c5a4500-d080-4910-b4cd-529caeb12ae3" class="title pmarker tags" data-element="title" data-tektur-editor-id="48fb367b-ff01-4e92-8e5b-bad42b9bd7cd" contenteditable="true">XQuery als Programmiersprache</div><div class="abstract optional show_menu tags" data-element="abstract" data-excluding="shortdesc" style="display:none" data-tektur-editor-id="cd63a3ba-96ee-4ed8-83c7-2a8b035bad8d"><div class="gui-optional-elements-button" contenteditable="false"><div class="menu-icon" style="display:none">+</div></div><div class="placeholder text pmarker tags" data-element="p" data-tektur-editor-id="5543e403-0848-4570-ad59-de0b3ff23dbd" contenteditable="true"></div></div><div data-attribute-id="ae4f3c4a-54be-4671-bba8-047bdf24b1d7" class="body show_menu tags" data-element="body" data-deletable="false" data-tektur-editor-id="573613d2-22bf-48d0-abab-916aecea93f8"><div class="gui-optional-elements-button" contenteditable="false"><div class="menu-icon" style="display:none">+</div></div><div class="section tektur-wrapper tags" data-element="section" data-tektur-editor-id="3b794690-9995-40f5-a194-fc69f5c0418f"><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="1e9a3c95-15bd-4eb0-89b8-59c8784a5425" class="p pmarker tags" data-element="p" data-tektur-editor-id="452622d5-58af-4357-8767-4b6fa7c7e419" contenteditable="true">Erste Schritte in XQuery gehen sehr schön  
mit der Query Konsole auf dem Marklogic Server (Port 8000).
Hat man parallel auch noch oXygen Editor offen, kann man die Testergebnisse aus der Konsole direkt in ein XQuery Server Skript packen.</div></div><div data-element="section" class="section optional show_menu tags" data-tektur-editor-id="f2d7ddea-a178-444e-8bd1-99d95361284e"><div class="gui-optional-elements-button" contenteditable="false"><div class="menu-icon" style="display:none">+</div></div><div data-attribute-id="fa1956ff-e468-4fb8-99dc-1a7a8f773707d6e7" class="title pmarker tags" data-element="title" data-tektur-editor-id="d18c030c-c5ac-4118-8365-129cadace125" contenteditable="true">Schleifen</div><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="5fdff6dd-6c8a-467c-880d-33c88f7de0ded6e9" class="p pmarker tags" data-element="p" data-tektur-editor-id="b2649939-8adf-408c-bc26-c6f43f94ad6c" contenteditable="true">Die ersten 10 Dokumente auf dem Server bekommt man z.B. mit:<span class="bracket-tags-marker" id="45636ed3-7e9e-42e5-acee-7ffdc805feaf">[[<span class="bracket-tags">xe1:Programmierkonstrukte;xe2:Schleifen - for</span>]]</span></div><div class="pre"><div data-attribute-id="c6978b40-ee7a-4517-9073-e45d110231c1d7e11" data-attribute-xml_space="preserve" class="pre-content pmarker tags" data-element="pre" data-tektur-editor-id="22e03ff1-1555-43c9-88cc-43c5fc9a0f8c" contenteditable="true">(doc())[position() lt 11]</div></div><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="b3785b18-f654-4483-85a6-bdbb21caa0e1d6e13" class="p pmarker tags" data-element="p" data-tektur-editor-id="b8721365-0c2e-4e5b-aca8-c3d87d3a92b3" contenteditable="true">Die Zahlen von 1 bis 100 mit:</div><div class="pre"><div data-attribute-id="fc9858f4-6a91-4fed-aa31-da9665307420d7e15" data-attribute-xml_space="preserve" class="pre-content pmarker tags" data-element="pre" data-tektur-editor-id="bd44620f-1b04-4e78-8a9f-63c37de20ce0" contenteditable="true">(for $i in (1 to 100) return $i)</div></div><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="7558c943-b4af-4b14-acf0-fc84efcebb90d6e17" class="p pmarker tags" data-element="p" data-tektur-editor-id="81944bec-2c19-43dd-8ca2-e2f2a597b68a" contenteditable="true">Wenn man diese beide Anweisungen untereinander in die Konsole
schreibt bekommt man einen Fehler. Trennt man sie mit einem 
Komma - ein Tupel wird erzeugt - dann klappt es.</div></div><div data-element="section" class="section optional show_menu tags" data-tektur-editor-id="a7a60a48-015a-4f2a-9ccf-2f6884e3e0c2"><div class="gui-optional-elements-button" contenteditable="false"><div class="menu-icon" style="display:none">+</div></div><div data-attribute-id="0bbb962d-b38e-431a-855a-294425a5a016d6e20" class="title pmarker tags" data-element="title" data-tektur-editor-id="32978958-388a-46df-9c9d-17f96547735f" contenteditable="true">Dokumente in der DB anlegen</div><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="68e15e0c-efc5-472f-87fe-4d2dd4352485d6e22" class="p pmarker tags" data-element="p" data-tektur-editor-id="e4a5c075-9f86-4b19-b2dc-8146e732c08d" contenteditable="true">Der Befehl zum Anlegen eines Dokuments in der Marklogic DB sieht
folgendermassen aus <span class="bracket-tags-marker" id="f749477d-d385-4ddb-8fc5-c8cbb4107d5c">[[<span class="bracket-tags">link</span>]]</span>(Doku)<span class="bracket-tags-marker" id="f1620a90-0d91-46fc-aecd-35222da87586">[[<span class="bracket-tags">fn:https://docs.marklogic.com/xdmp:document-insert*Doku zu xdmp:documen-insert Funktion auf den MarkLogic Webseiten</span>]]</span>:<span class="bracket-tags-marker" id="77d0143a-b7f1-4417-9ad6-e19db4b75008">[[<span class="bracket-tags">xe1:Programmierkonstrukte;xe2:DB insert</span>]]</span></div><div class="pre"><div data-attribute-id="34209f36-676d-4362-8bd7-71cfc2d8a32ad7e24" data-attribute-xml_space="preserve" class="pre-content pmarker tags" data-element="pre" data-tektur-editor-id="d4bb8c90-c744-4f5a-84d2-d94d9dfa5cda" contenteditable="true">xdmp:document-insert(
  "/alex-test/example-alex.xml",
  &#x3C;root&#x3E;Hier steht der Content&#x3C;/root&#x3E;, 
  &#x3C;options xmlns="xdmp:document-insert"&#x3E;  
    &#x3C;metadata&#x3E;{
      map:map() =&#x3E; map:with("valid-start", "2014-06-03T14:13:05.472585-07:00")
      =&#x3E; map:with("valid-end", "9999-12-31T11:59:59Z")
      }&#x3C;/metadata&#x3E;
  &#x3C;/options&#x3E;)</div></div><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="0db3e46f-54fa-4858-b85d-ad36ded2bf2ad6e26" class="p pmarker tags" data-element="p" data-tektur-editor-id="d2ad3c28-f7f9-4479-93e8-3efc324b2a22" contenteditable="true">Packt man diese Instruktion in die for-Schleife oben, dann sieht das Konstrukt so aus:</div><div class="pre"><div data-attribute-id="46bd4751-bf50-4b18-b456-35bc2c877980d7e28" data-attribute-xml_space="preserve" class="pre-content pmarker tags" data-element="pre" data-tektur-editor-id="c6ec1d16-56b1-42d4-a43e-44ca3c47aa19" contenteditable="true">(for $i in (1 to 10) return 
  xdmp:document-insert(
  concat("/alex-test/example-alex-",$i,".xml"),
  &#x3C;root&#x3E;Hier steht der Content {$i}&#x3C;/root&#x3E;, 
  &#x3C;options xmlns="xdmp:document-insert"&#x3E;  
    &#x3C;metadata&#x3E;{
      map:map() =&#x3E; map:with("valid-start", "2014-06-03T14:13:05.472585-07:00")
      =&#x3E; map:with("valid-end", "9999-12-31T11:59:59Z")
      }&#x3C;/metadata&#x3E;
  &#x3C;/options&#x3E;)
)</div></div><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="ccd162ef-82c4-45f2-8a4d-a72e51647514d6e30" class="p pmarker tags" data-element="p" data-tektur-editor-id="11e56838-0b3c-480c-8cf1-2be1adb15b19" contenteditable="true">Dokumente kann man einer Collection<span class="bracket-tags-marker" id="8844fd4a-30f4-4815-a313-212ca650b982">[[<span class="bracket-tags">xe1:Programmierkonstrukte;xe2:DB Collection</span>]]</span> zuweisen, um sie leichter finden und auswerten
zu können. Das geht mit dem folgenden Befehl <span class="bracket-tags-marker" id="7efec3cf-6c05-4869-8c42-be476dc0dbaf">[[<span class="bracket-tags">link</span>]]</span>(Doku)<span class="bracket-tags-marker" id="cf6eafb5-a146-4c81-8900-f8f77710d506">[[<span class="bracket-tags">fn:https://docs.marklogic.com/xdmp:document-add-collections*Dokumentation zur xdmp:document-add-collections Funktion auf den MarkLogic Webseiten</span>]]</span> und diesem Schnippsel:</div><div class="pre"><div data-attribute-id="54b25836-7a45-4aeb-b095-95e920f699bad7e32" data-attribute-xml_space="preserve" class="pre-content pmarker tags" data-element="pre" data-tektur-editor-id="59c28010-68e8-444b-8d24-56adf6f6971e" contenteditable="true">let $root :=
&#x3C;mein-test&#x3E;
   &#x3C;id&#x3E;{$id}&#x3C;/id&#x3E;
   &#x3C;content&#x3E;Hallo Welt!&#x3C;/content&#x3E;
&#x3C;/mein-test&#x3E;,
$options :=
&#x3C;options xmlns="xdmp:document-insert"&#x3E;  
  &#x3C;permissions&#x3E;{xdmp:default-permissions()}&#x3C;/permissions&#x3E;
  &#x3C;collections&#x3E;
    &#x3C;collection&#x3E;/alex-test&#x3C;/collection&#x3E;
  &#x3C;/collections&#x3E;
&#x3C;/options&#x3E;,
$fname := concat('/',$id,'_','.xml'),
$td := xdmp:document-insert($fname,$root,$options)
return 
  [...]</div></div><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="089d273b-a358-45a2-857e-181948135159d6e34" class="p pmarker tags" data-element="p" data-tektur-editor-id="66f3e376-7ca3-4d8d-acc1-1a8db6ac5e3b" contenteditable="true">Die Dokumente, die mit der Collection alex-test getaggt wurden, kann man sich mit der folgenden Schleife ausgeben lassen:</div><div class="pre"><div data-attribute-id="5f9f00fc-80d3-4091-87e6-f4bbccb131f7d7e36" data-attribute-xml_space="preserve" class="pre-content pmarker tags" data-element="pre" data-tektur-editor-id="612d6a82-6629-417e-87b6-7d3a2cc5d2fd" contenteditable="true">for $x in collection("/alex-test")
  return
    fn:document-uri($x)</div></div><div class="placeholder text pmarker tags" data-element="p" data-tektur-editor-id="e86b35e8-6ea5-48f3-980b-8c26e40e9323" contenteditable="true"></div></div></div></div>