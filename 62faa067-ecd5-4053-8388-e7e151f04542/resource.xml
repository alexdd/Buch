<?xml version="1.0" encoding="UTF-8"?><topic id="c25b36c1-64f0-4fff-8445-8dc096e98096"><title id="877dafce-2dfe-4a6f-9483-cfe566858b83">Ausführen einiger Beispiel-Queries </title><body id="48877454-f109-4d47-9192-0575f181f939"><p id="2459f527-8e4e-4230-9966-7c387208de9b">Wie im vorherigen Kapitel beschrieben, muss in der Konsolensitzung zwischen Anlegen der Originalversion und der Aktualisierung eine Verzögerung eingebaut werden, um irgendwie das "Zeitloch" zu simulieren, in dem - wenn wir bei dem vorherigen Beispiel bleiben -  der Personalausweis als Verlust gemeldet war, aber tatsächlich schon wieder in meinem Besitz war.</p><p id="699e7bf9-bd79-4a39-be86-f018583ec67dd6e6">Ohne jetzt groß [[code:validStart]] und [[code:validEnd]] anzupassen, habe ich das Beispiel mit einer Verzögerung von 50 Sekunden lassen:</p><pre id="2b88ba3a-328c-4f22-9c17-c4749c3e289bd7e8" xml:space="preserve">( xdmp:invoke-function(local:create-temporal-fields#0),
  xdmp:invoke-function(local:create-range-index-fields#0),
  xdmp:invoke-function(local:create-axes#0),
  xdmp:invoke-function(local:create-temporal-collection#0),
  xdmp:invoke-function(local:insert-original#0),
  <b id="fda3ce2f-fcf8-4063-ad94-d54875a360f2d6e10">xdmp:sleep(50000),</b>
  xdmp:invoke-function(local:insert-update#0))</pre><p id="16e38ef6-1840-4045-a53b-c4fcf6103b4ad6e10">Und bekomme folgendes Ergebnis:</p><table id="c4bd0531-72dc-4551-9712-58a21abef158d6e12" pgwide="1" frame="all" scale="50" status="changed"><desc id="24c598bc-01cd-4a47-a191-c56d8825476dd7e16">Diese Daten wurde aus der Exploreransicht der Konsolensitzung entnommen. </desc><tgroup id="1d7b4be5-37ce-445d-9c86-80ef49880e55d7e18" cols="5"><colspec id="1e9c6ea1-72e4-45d0-81af-ae594c13ec70d7e19" colwidth="187px" colname="col0"/><colspec id="81084ad4-184e-46a5-9eac-e8c731f9bcbfd7e20" colwidth="220px" colname="col1"/><colspec id="8e798b95-f919-46bf-87ab-6323394582f3d7e21" colwidth="222px" colname="col2"/><colspec id="01047d75-00b1-4859-a161-b9a6bb7ddb51d7e22" colwidth="211px" colname="col3"/><colspec id="8ecc7c23-b0d0-47ee-a917-b7014b4aadc0d7e23" colwidth="225px" colname="col4"/><thead id="7425a11e-1404-4272-b9c7-640b254c7c12d7e24"><row id="1bd01a81-b580-494f-a838-d735a95ebc7ed7e25"><entry id="e981bb09-977b-446f-b042-30e3e70115b8d7e26" colname="col0" width="187px"><p id="3b858260-3132-4744-822a-388757bf1ca7d6e22">Document</p></entry><entry id="6ce9ddea-f294-4955-936e-0a6839a3c755d7e29" colname="col1" width="220px"><p id="96fa723c-32d1-4215-8ea6-34f4c4e8d4e0d6e28">validStart</p></entry><entry id="07bceca6-e57e-443e-a91a-ff5061f78887d7e32" colname="col2" width="222px"><p id="f3f4d9b2-d393-47f7-88f9-f0bd49c13be2d6e34">validEnd</p></entry><entry id="df2f733b-56b3-40bd-954c-5e30945c5d78d7e35" colname="col3" width="211px"><p id="6738e10e-4028-4824-bd5a-2f31fc7276a9d6e37">systemStart</p></entry><entry id="6c208755-de4c-45a3-a0ce-7b1035ce1e2ad7e38" colname="col4" width="225px"><p id="abe482e7-7fea-4484-a3bc-7838a551a318d6e40">systemEnd</p></entry></row></thead><tbody id="02bc5c91-19a9-452a-92d5-27f9c968be9dd7e41"><row id="e0cdd0ca-9f41-47b5-8d97-2d99555a5ed2d7e42"><entry id="0d19fb4d-57f3-4671-905b-680488255c94d7e43" colname="col0" width="187px"><p id="1c29ef78-25db-4140-b0cf-2434fe62501fd6e33">duesel_alex_270774.2462380991258156208.xml</p></entry><entry id="0cae814c-bc54-4eed-bd8f-7dcd53ac8d46d7e46" colname="col1" width="220px"><p id="05c544a3-7bd5-4253-b5ee-67dabcabfbf4d6e51">2019-03-19T14:17:00</p></entry><entry id="a5c67d7e-d8d7-4878-8a5f-e6a102ff8c01d7e49" colname="col2" width="222px"><p id="7b570410-dfd1-48dc-a64c-5ff7ee9f84d1d6e54"><b id="e2968d95-6b67-479c-a4bc-d962ab336dc4d6e55">unendlich</b></p></entry><entry id="d82987fb-d15f-4724-a402-924d6a7466bcd7e53" colname="col3" width="211px"><p id="f84359ce-723b-4894-9c92-ffcea49f4624d6e58">2019-03-19T13:18:28</p></entry><entry id="5e6e5973-d077-449c-b613-643ab4aabec4d7e56" colname="col4" width="225px"><p id="093daa5f-3d5f-4d81-beb6-e196c438fcd5d6e61">2019-03-19T13:19:18</p></entry></row><row id="87338937-358a-4be9-804b-118623e5798ed7e59"><entry id="e209cd83-04cc-45b4-8a94-a2e85d83befcd7e60" colname="col0" width="187px"><p id="80b154da-dd44-41e9-9478-c6902e4b4bb1d6e41">duesel_alex_270774.819911042637597172.xml</p></entry><entry id="d43b251a-a1ca-4ba1-8741-1d29d721391ad7e63" colname="col1" width="220px"><p id="865093ca-d4e5-4225-a791-45f80ad8fb7ed6e71">2019-03-19T14:17:00</p></entry><entry id="a2be5e65-2d16-4bf7-a8ba-dc5c4f09db8ed7e66" colname="col2" width="222px"><p id="b274b678-7150-4874-a037-23b792835749d6e74">2019-03-19T14:18:00</p></entry><entry id="07b42295-70a5-4809-8876-eeeb5a048181d7e69" colname="col3" width="211px"><p id="c41e2883-6169-491b-a011-982003d98c89d6e77">2019-03-19T13:19:18</p></entry><entry id="95b84ee8-d439-4137-8c14-2aa8f685eab1d7e72" colname="col4" width="225px"><p id="604a1931-45e7-48e9-879c-325749779335d6e80"><b id="679a6f9d-2685-4c2f-9f04-929aa5c31d02d6e81">unendlich</b></p></entry></row><row id="e2a87177-0da9-40ce-a545-8a1800cd6c25d7e76"><entry id="fdc220f0-7484-42a1-a131-678a506f0a66d7e77" colname="col0" width="187px"><p id="1a49c7fb-9c2d-420d-aaf7-12f4c3c8c11dd6e49">duesel_alex_270774.xml</p></entry><entry id="abacdc29-3d37-4094-a00f-9030a62c5eead7e80" colname="col1" width="220px"><p id="2d55653f-3aff-4633-ab66-6de296a620f7d6e91">2019-03-19T14:18:00</p></entry><entry id="3f73f558-2638-4f4e-bde7-a442909cde8cd7e83" colname="col2" width="222px"><p id="59329648-b091-46a1-8e6a-6247f0c7c617d6e94"><b id="adff2f4d-1eb4-4549-a972-99b4a7dd047ed6e82">unendlich</b></p></entry><entry id="85c06f61-42e2-47b4-9893-e3430ce9b992d7e87" colname="col3" width="211px"><p id="22c74575-6baf-4a2b-9da6-1fb880a2b15ed6e97">2019-03-19T13:19:18</p></entry><entry id="1c13bda5-32f4-4225-ae19-e5c7ae2c4744d7e90" colname="col4" width="225px"><p id="79110572-309b-4067-8121-9f9a456f8e1cd6e100"><b id="f2bc6042-2a22-49dc-b3d4-d22591503a53d6e101">unendlich</b></p></entry></row></tbody></tgroup></table><p id="ab1286fb-98c0-432c-bf1f-60bf116968a2d6e90">Wie man sieht, müsste sich jetzt das Zeitloch von 50 Sekunden der Systemzeiten innerhalb der gültigen Zeiten befinden, um das Beispiel mit dem verlorenen Ausweis zumindest für die Zeitspanne von 50 Sekunden simulieren zu können. </p><p id="6bea37b1-3981-4fda-8afb-6d40e27b4838d6e96">Das korrekte Setup bleibt an dieser Stelle dem geneigten Leser selbst überlassen.</p><p id="059b400f-b00a-4a79-944c-c54a2cbec2b0d6e93">Zwei Queries, die die Werte in der Tabelle illustriere sind bspw. folgende:</p><fig id="7bf15aca-948d-4c7f-98cf-88dfdfe3fe12d6e100"><desc id="b1354f32-7b9b-458d-ab4b-dc40c6db5044d7e101">Bei dieser Query werden alle Dokumente gesucht, deren gültiger Zeitraum, den Zeitraum zwischen 14:17 Uhr und 14:18 Uhr umfasst. Das sind das Split-Dokument und das Original-Dokument. Beide mit dem Status "gestolen", da erst um 14:18 Uhr der Fund bekannt gegeben wurde.</desc><image id="7510906e-d2cc-404e-9b3d-21a1a05cc770d7e103" href="result1.png"/></fig><fig id="32a24603-aecc-4907-a739-c098cb2fbce4d6e104"><desc id="debd38cf-cd65-46eb-9aae-a021ccb7917cd7e105">Verändert man den Zeitraum nach 18:00 Uhr, so wird das Original - wie erwartet - durch das Update verdrängt.</desc><image id="c9924800-3a9f-49e2-9e5e-da372d390355d7e107" href="result2.png"/></fig><fig id="05104f53-6fdc-42ac-8063-23e2aefdccc6d6e108"><desc id="b292e011-dab7-4158-9b3d-5dc517f25fded7e109">Die aktuelle Version des temporal verwalteten Dokuments ist in der Collection "<i id="5fb358f2-9a8a-48ce-b92e-2732bb8a695dd6e111">latest</i>" gespeichert.</desc><image id="72adb68a-f218-4e8b-8a89-e33db3409ed2d7e114" href="result_3.png"/></fig><p id="b609d2ea-c4d2-4b17-839e-3fc77a984064d6e116">Wie man sie kann man - ausreichend Lösungsphantasie vorausgesetzt - einiges mit diesen Queries anstellen. Hilfreich ist sicherlich auch die umfangreiche Liste der Vergleichsoperatoren, die MarkLogic zum Vergleichen von Zeiträumen bereitstellt: [[link]]ISO Operator[[fn:https://docs.marklogic.com/guide/temporal/searching#id_92200*ISO normierte Operatoren in MarkLogic zum Vergleichen von Zeiträumen]] und [[link]]ALLEN Operators[[fn:https://docs.marklogic.com/guide/temporal/searching#id_98704*Allen (ALN) Vergleichsoperatoren für Zeiträume]].</p></body></topic>