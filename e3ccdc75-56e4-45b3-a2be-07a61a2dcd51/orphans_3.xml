<?xml version="1.0" encoding="UTF-8"?><elements><element id="da1019bd-a41f-4a7e-865f-d0d9cd7dbc4fd7e15">&lt;xsl:key name=\"parts\"match=\"part\"use=\"@id\"\/&gt; &lt;xsl:template match=“part” mode=“content\"&gt; &lt;!-- Ausgabe des Bauteils im Content Bereich --&gt; &lt;fo:block id=\"{generate-id()}\"&gt; &lt;fo:external-graphic xsl:use-attribute-sets=\"part.img\"\/&gt; &lt;\/fo:block&gt; &lt;\/xsl:template&gt; &lt;xsl:template match=“part” mode=“part-list\"&gt; &lt;!-- Ausgabe einer Liste mit allen Verweisen an unterschiedicher Stelle --&gt; &lt;fo:block&gt; &lt;xsl:for-each select=\"key('parts',@id)\"&gt; &lt;fo:page-number-citation ref-id=\"{generate-id()}\"\/&gt; &lt;\/xsl:for-each&gt; &lt;\/fo:block&gt; &lt;\/xsl:template&gt;</element><element id="1fc390e4-02ee-4c39-8b69-d7a38d1efe3ad7e25">WRAPPER1 SEQUENZ1 SEQUENZ2 SEQUENZ3 WRAPPER2 SEQUENZ1 SEQUENZ2 SEQUENZ3 SEQUENZ4 WRAPPER3 SEQUENZ1 SEQUENZ2 CONTENT DATA1 DATA2 DATA3 DATA4 DATA5 CONTENT DATA1 DATA2 DATA3 DATA4 DATA5 WRAPPER4 SEQUENZ1 CONTENT DATA1 DATA2 DATA3 DATA4 DATA5 [...]</element><element id="c6dafc95-e654-4f13-b511-b34013ca9940d7e29">&lt;xsl:stylesheet xmlns:xsl=\"http:\/\/www.w3.org\/1999\/XSL\/Transform\"version=\"2.0\"&gt; &lt;xsl:output method=\"xml\"indent=\"yes\"\/&gt; &lt;xsl:strip-space elements=\"*\"\/&gt; &lt;xsl:template match=\"\/\"&gt; &lt;xsl:apply-templates select=\"\/WRAPPER1\/WRAPPER2\/WRAPPER3\/CONTENT\"mode=\"umschlag\"\/&gt; &lt;\/xsl:template&gt; &lt;xsl:template match=\"CONTENT\"mode=\"umschlag\"&gt; &lt;xsl:result-document href=\"{concat(@id,'.xml')}\"&gt; &lt;umschlag&gt; &lt;metadaten&gt;&lt;!-- einige Metadaten --&gt;&lt;\/env:metadata&gt; &lt;nutzdaten&gt; &lt;xsl:apply-templates select=\"ancestor::WRAPPER1\"&gt; &lt;xsl:with-param name=\"this-id\"select=\"generate-id()\"tunnel=\"yes\"\/&gt; &lt;\/xsl:apply-templates&gt; &lt;\/nutzdaten&gt; &lt;\/umschlag&gt; &lt;\/xsl:result-document&gt; &lt;\/xsl:template&gt; &lt;xsl:template match=\"node()|@*\"&gt; &lt;xsl:copy&gt; &lt;xsl:apply-templates select=\"node()|@*\"\/&gt; &lt;\/xsl:copy&gt; &lt;\/xsl:template&gt; &lt;xsl:template match=\"CONTENT\"&gt; &lt;xsl:param name=\"this-element\"tunnel=\"yes\"\/&gt; &lt;xsl:if test=\"$this-id = generate-id()\"&gt; &lt;xsl:copy&gt; &lt;xsl:apply-templates select=\"node()|@*\"\/&gt; &lt;\/xsl:copy&gt; &lt;\/xsl:if&gt; &lt;\/xsl:template&gt; &lt;\/xsl:stylesheet&gt;</element><element id="3554af39-a8d1-461b-b1dd-26fc1c984213d7e15">&lt;xsl:key name=\"parts\" match=\"part\" use=\"@id\"\/&gt; &lt;xsl:template match=“part” mode=“content\"&gt; &lt;!-- Ausgabe des Bauteils im Content Bereich --&gt; &lt;fo:block id=\"{generate-id()}\"&gt; &lt;fo:external-graphic xsl:use-attribute-sets=\"part.img\"\/&gt; &lt;\/fo:block&gt; &lt;\/xsl:template&gt; &lt;xsl:template match=“part” mode=“part-list\"&gt; &lt;!-- Ausgabe einer Liste mit allen Verweisen an unterschiedicher Stelle --&gt; &lt;fo:block&gt; &lt;xsl:for-each select=\"key('parts',@id)\"&gt; &lt;fo:page-number-citation ref-id=\"{generate-id()}\"\/&gt; &lt;\/xsl:for-each&gt; &lt;\/fo:block&gt; &lt;\/xsl:template&gt;</element><element id="1f7fbd3e-ab8a-44a2-9bb9-b1f6e93be1a4d7e25">WRAPPER1 SEQUENZ1 SEQUENZ2 SEQUENZ3 WRAPPER2 SEQUENZ1 SEQUENZ2 SEQUENZ3 SEQUENZ4 WRAPPER3 SEQUENZ1 SEQUENZ2 CONTENT DATA1 DATA2 DATA3 DATA4 DATA5 CONTENT DATA1 DATA2 DATA3 DATA4 DATA5 WRAPPER4 SEQUENZ1 CONTENT DATA1 DATA2 DATA3 DATA4 DATA5 [...]</element><element id="c5aec956-9110-4e4c-9e69-cb60db10b9e4d7e29">&lt;xsl:stylesheet xmlns:xsl=\"http:\/\/www.w3.org\/1999\/XSL\/Transform\" version=\"2.0\"&gt; &lt;xsl:output method=\"xml\" indent=\"yes\"\/&gt; &lt;xsl:strip-space elements=\"*\"\/&gt; &lt;xsl:template match=\"\/\"&gt; &lt;xsl:apply-templates select=\"\/WRAPPER1\/WRAPPER2\/WRAPPER3\/CONTENT\" mode=\"umschlag\"\/&gt; &lt;\/xsl:template&gt; &lt;xsl:template match=\"CONTENT\" mode=\"umschlag\"&gt; &lt;xsl:result-document href=\"{concat(@id,'.xml')}\"&gt; &lt;umschlag&gt; &lt;metadaten&gt;&lt;!-- einige Metadaten --&gt;&lt;\/env:metadata&gt; &lt;nutzdaten&gt; &lt;xsl:apply-templates select=\"ancestor::WRAPPER1\"&gt; &lt;xsl:with-param name=\"this-id\" select=\"generate-id()\" tunnel=\"yes\"\/&gt; &lt;\/xsl:apply-templates&gt; &lt;\/nutzdaten&gt; &lt;\/umschlag&gt; &lt;\/xsl:result-document&gt; &lt;\/xsl:template&gt; &lt;xsl:template match=\"node()|@*\"&gt; &lt;xsl:copy&gt; &lt;xsl:apply-templates select=\"node()|@*\"\/&gt; &lt;\/xsl:copy&gt; &lt;\/xsl:template&gt; &lt;xsl:template match=\"CONTENT\"&gt; &lt;xsl:param name=\"this-element\" tunnel=\"yes\"\/&gt; &lt;xsl:if test=\"$this-id = generate-id()\"&gt; &lt;xsl:copy&gt; &lt;xsl:apply-templates select=\"node()|@*\"\/&gt; &lt;\/xsl:copy&gt; &lt;\/xsl:if&gt; &lt;\/xsl:template&gt; &lt;\/xsl:stylesheet&gt;</element></elements>