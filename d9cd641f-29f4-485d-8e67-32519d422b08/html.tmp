<div data-attribute-id="7f9615d0-3d92-4ec1-813b-db4b788b6efd" class="topic show_menu tags" data-element="topic" data-deletable="false" data-tektur-editor-id="d612a809-edeb-4cb3-b7e4-298461c779b1"><div class="gui-optional-elements-button" contenteditable="false"><div class="menu-icon" style="display:none">+</div></div><div data-attribute-id="86a66f53-eb4a-4cc0-b14c-12d5c2bb84bd" class="title pmarker tags" data-element="title" data-tektur-editor-id="60f7f573-a3d2-410b-876d-b809e8d12fbe" contenteditable="true"><span class="bracket-tags-marker" id="c6e27f01-817d-407d-9888-04831c203201">[[<span class="bracket-tags">code:if..then..else</span>]]</span> Ausdrücke</div><div class="abstract optional show_menu tags" data-element="abstract" data-excluding="shortdesc" style="display:none" data-tektur-editor-id="d5a0eb2e-77d6-455d-80ba-c9bf862230a6"><div class="gui-optional-elements-button" contenteditable="false"><div class="menu-icon" style="display:none">+</div></div><div class="placeholder text pmarker tags" data-element="p" data-tektur-editor-id="c95c8ac5-723b-42ab-9fd7-9aa86c219da0" contenteditable="true"></div></div><div data-attribute-id="c47ce675-c5d5-48bd-a4f9-73eb4cb6297c" class="body show_menu tags" data-element="body" data-deletable="false" data-tektur-editor-id="ec0aad07-b2c9-41ef-9d28-edfa2c7b1b80"><div class="gui-optional-elements-button" contenteditable="false"><div class="menu-icon" style="display:none">+</div></div><div class="section tektur-wrapper tags" data-element="section" data-tektur-editor-id="626eab8b-71d2-49ca-b36a-16e52c531b4f"><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="31bf12f5-ecec-4ada-965f-cb4e1539afc6" class="p pmarker tags" data-element="p" data-tektur-editor-id="88dd8bf7-937f-4d35-b9da-7b6e6e65fcc8" contenteditable="true">In nicht-funktionalen Programmiersprachen sind die Schlüsselwörter <span class="bracket-tags-marker" id="5ac62063-a18c-48f9-9f15-d85d6bc16983">[[<span class="bracket-tags">code:if</span>]]</span> und <span class="bracket-tags-marker" id="c7309bbb-a37b-408b-b57d-8719818de12c">[[<span class="bracket-tags">code:then</span>]]</span><span class="bracket-tags-marker" id="b922ba53-21ce-4acc-b2ca-ad573641f880">[[<span class="bracket-tags">xe1:Programmierkonstrukte;xe2:Bedingte Anweisung - if..then..else</span>]]</span> dazu da, um dem Compiler oder Interpreter mitzuteilen, dass eine bedingte Anweisung ausgewertet werden soll.</div><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="c9ab5b21-d799-4bb6-a020-d7ab5750146ed6e12" class="p pmarker tags" data-element="p" data-tektur-editor-id="d94a3ca4-7ea0-46a5-b4ed-9aa6ca6e40df" contenteditable="true">Was für den Nicht-funktionalen Programmierer etwas befremdlich erscheint, ist der Umstand, dass in XQuery <span class="bracket-tags-marker" id="542f653b-d3c8-4a08-ab8b-1efccab2178a">[[<span class="bracket-tags">code:if..then</span>]]</span> als Ausdrücke ausgewertet werden.</div><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="e4d038c8-39fe-4f47-a81c-4a7d16a10c3ed6e17" class="p pmarker tags" data-element="p" data-tektur-editor-id="a33f68ad-7301-4010-a1a0-cf5e38a2e59b" contenteditable="true">Das ist einerseits sehr praktisch, weil es richtig angewandt den Code verkürzt und damit das Wesentliche herausstellt, kann aber auch weiter zur allg. Verwirrung bzgl. des kryptischen XQuery Codes beitragen.</div></div><div data-element="section" class="section optional show_menu tags" data-tektur-editor-id="626db60c-6efa-4cd3-9319-70628cb651e3"><div class="gui-optional-elements-button" contenteditable="false"><div class="menu-icon" style="display:none">+</div></div><div data-attribute-id="b0df228c-1f72-4a12-9302-805fa0022b03d6e11" class="title pmarker tags" data-element="title" data-tektur-editor-id="9c032600-33d3-4633-9066-72e0d89f0e8d" contenteditable="true">Beispiel: Konditionale Server App</div><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="2d0364b2-f8b1-47fa-996e-0f9ceba95e4fd6e13" class="p pmarker tags" data-element="p" data-tektur-editor-id="8ed12d60-4b0d-49ac-af1c-dc9bf5c49b74" contenteditable="true">Betrachten wir ein einfaches Beispiel: Wir generieren auf einer Marklogic-Webapp eine JSON Response. Da wir diesen Mechanismus an mehreren Stellen im Code einsetzen, empfiehlt es sich das Rendern des Headers in eine Funktion auszulagern.</div><div class="pre"><div data-attribute-id="b7fcfd8d-540e-41ff-88df-409e5d465680d7e15" data-attribute-xml_space="preserve" class="pre-content pmarker tags" data-element="pre" data-tektur-editor-id="ee28641a-5839-4cb2-87d2-417a7d0de6c5" contenteditable="true">declare function common:wrap-response($json)
{
  xdmp:add-response-header("Pragma", "no-cache"),
  xdmp:add-response-header("Cache-Control", "no-cache"),
  xdmp:add-response-header("Expires", "0"),
  xdmp:set-response-content-type('text/json; charset=utf-8'),
  $json
};</div></div><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="9c2999c6-968d-4719-9036-fd0664b5bd57d6e19" class="p pmarker tags" data-element="p" data-tektur-editor-id="e2764979-888f-41ce-ab23-7726def7ae61" contenteditable="true">In unserem Request-Handler wird je nach Auswertung einer Variablen eine 
bedingte Anweisung ausgeführt, diese sieht bspw. so aus:</div><div class="pre"><div data-attribute-id="461dc77f-4392-41bf-8805-cce701f39660d7e19" data-attribute-xml_space="preserve" class="pre-content pmarker tags" data-element="pre" data-tektur-editor-id="2db155e9-7c26-4cd0-bb14-7ea9e1b73c18" contenteditable="true">let $name := xdmp:get-request-field('name'),
    $is-afternoon := xs:time(current-dateTime()) gt xs:time('12:00:00')
return 
  if ($is-afternoon) then 
   common:wrap-response(xdmp:unquote(concat('{"greeting":"Good Afternoon! ',$name,'!"}')))
  else
   common:wrap-response(xdmp:unquote(concat('{"greeting":"Good Morning! ',$name,'!"}')))</div></div><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="7795845c-ea88-42f8-8adf-ab4d0b5404fcd6e23" class="p pmarker tags" data-element="p" data-tektur-editor-id="96350148-f5d7-468a-8a5c-cd61b05e4dd1" contenteditable="true">Als prozeduraler Programmierer wäre ich mit diesem Switch voll und ganz zufrieden, 
der funktionale Programmier erkennt abaer sofort einen Optimierungsbedarf.</div><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="a553de2e-d73c-4a97-a1b1-5283220ffef3d6e25" class="p pmarker tags" data-element="p" data-tektur-editor-id="f5e6853a-a6b4-44fa-b5b8-ef3f50f4d7af" contenteditable="true">Da es sich bei der bedingten Anweisung auch um einen Ausdruck handelt, der [[code:true}} oder [[code:false}} zurückgibt, können wir die gleichen Funktionsaufrufe herausziehen:</div><div class="pre"><div data-attribute-id="e7eecafb-f11b-4891-b8c7-e9a7c267328ad7e25" data-attribute-xml_space="preserve" class="pre-content pmarker tags" data-element="pre" data-tektur-editor-id="9b27a343-12a2-4163-a250-5083eaca2683" contenteditable="true">ommon:wrap-response(xdmp:unquote(
    let $is-afternoon := xs:time(current-dateTime()) gt xs:time('12:00:00')
        return 
            if ($is-afternoon) then concat('{"greeting":"Good Afternoon! ',$name,'!"}') 
            else concat('{"greeting":"Good Morning! ',$name,'!"}')
)</div></div><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="c1d6576a-56e3-4dda-bc18-342e7e458553d6e29" class="p pmarker tags" data-element="p" data-tektur-editor-id="f14ac65d-f26f-474f-b251-b6173f6d16c5" contenteditable="true">Hier wird der abstrakt denkende Programmierer aber einwenden, dass eine abstrakte
Logik nicht in eine Low-Level Funktion, wie [code:xsdmp:unquote] gewrapped werden sollte.</div><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="a935a64f-2ed6-4682-84cb-3243f9dcbb49d6e31" class="p pmarker tags" data-element="p" data-tektur-editor-id="35bbe80c-6fd2-4d49-9bf3-106a9be782f9" contenteditable="true">Das stimmt - und mehr noch, die Maskierung mit <span class="bracket-tags-marker" id="dea1d92d-66c2-46a8-b81f-7a9319738ca5">[[<span class="bracket-tags">code:xsdmp:unquote</span>]]</span> sollte auch noch in unsere 
Funktion gepackt werden. So dass der Code schliesslich so aussehen würde:</div><div class="pre"><div data-attribute-id="150e3b72-142f-4b2f-acf4-4c46bc843071d7e31" data-attribute-xml_space="preserve" class="pre-content pmarker tags" data-element="pre" data-tektur-editor-id="6a4f490c-ea3a-4533-bf36-860e811efb20" contenteditable="true">declare function common:render-response($json)
{
  xdmp:add-response-header("Pragma", "no-cache"),
  xdmp:add-response-header("Cache-Control", "no-cache"),
  xdmp:add-response-header("Expires", "0"),
  xdmp:set-response-content-type('text/json; charset=utf-8'),
  xdmp:unquote($json)
};

common:render-response(
    let $is-afternoon := xs:time(current-dateTime()) gt xs:time('12:00:00')
        return 
            if ($is-afternoon) then concat('{"greeting":"Good Afternoon! ',$name,'!"}') 
            else concat('{"greeting":"Good Morning! ',$name,'!"}')
)</div></div><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="0a519a5c-c908-4d55-a9e8-d8ad9a4e7a81d6e36" class="p pmarker tags" data-element="p" data-tektur-editor-id="43f37502-d0ae-4165-9d16-7dba131cd7c6" contenteditable="true">Sicherlich lässt sich darüber streiten, ob nun der funktionale Ansatz besser lesbar ist als
der prozedurale ganz oben.</div><div xmlns:xr="http://www.tekturcms.de/2012/xr/common" xmlns:xlink="http://www.w3.org/1999/xlink" data-attribute-id="175752a8-d929-4081-83cf-c74b67da7d35d6e38" class="p pmarker tags" data-element="p" data-tektur-editor-id="b4032517-97f4-4957-be20-60966fa4d9a3" contenteditable="true">Ich denke jeder Programmierer hat hier seinen eigenen, individuellen
und bewährten Programmierstil entwickelt, den er auch beibehalten sollte.</div></div></div></div>